var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function s(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function m(){return f("")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function b(t,e){t.value=null==e?"":e}function $(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}let y;function v(t){y=t}function k(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(t)}const x=[],_=[],w=[],E=[],C=Promise.resolve();let S=!1;function N(t){w.push(t)}const j=new Set;let A=0;function O(){const t=y;do{for(;A<x.length;){const t=x[A];A++,v(t),z(t.$$)}for(v(null),x.length=0,A=0;_.length;)_.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];j.has(e)||(j.add(e),e())}w.length=0}while(x.length);for(;E.length;)E.pop()();S=!1,j.clear(),v(t)}function z(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}const P=new Set;let T;function B(t,e){t&&t.i&&(P.delete(t),t.i(e))}function L(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),T.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function R(t){t&&t.c()}function q(t,n,c,i){const{fragment:s,on_mount:l,on_destroy:u,after_update:a}=t.$$;s&&s.m(n,c),i||N((()=>{const n=l.map(e).filter(r);u?u.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(N)}function G(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function M(t,e){-1===t.$$.dirty[0]&&(x.push(t),S||(S=!0,C.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function U(e,r,c,i,s,l,a,f=[-1]){const d=y;v(e);const m=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(d?d.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||d.$$.root};a&&a(m.root);let p=!1;if(m.ctx=c?c(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return m.ctx&&s(m.ctx[t],m.ctx[t]=r)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](r),p&&M(e,t)),n})):[],m.update(),p=!0,o(m.before_update),m.fragment=!!i&&i(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(u)}else m.fragment&&m.fragment.c();r.intro&&B(e.$$.fragment),q(e,r.target,r.anchor,r.customElement),O()}v(d)}class D{$destroy(){G(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const I=[];function J(t,e){return{subscribe:F(t,e).subscribe}}function F(e,n=t){let o;const r=new Set;function i(t){if(c(e,t)&&(e=t,o)){const t=!I.length;for(const t of r)t[1](),I.push(t,e);if(t){for(let t=0;t<I.length;t+=2)I[t][0](I[t+1]);I.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(c,s=t){const l=[c,s];return r.add(l),1===r.size&&(o=n(i)||t),c(e),()=>{r.delete(l),0===r.size&&(o(),o=null)}}}}const H=J(null,(function(t){const e={},n=/([^&;=]+)=?([^&;]*)/g,o=window.location.hash.substring(1);let r;for(;r=n.exec(o);)e[r[1]]=decodeURIComponent(r[2]);t(e.access_token),window.history.pushState("object or string","Title","/")})),K=J(null,(function(t){t("http://localhost:8080/")})),Q=F("medium_term"),V=F(!1),W=F(null);function X(t,e,n){const o=t.slice();return o[6]=e[n],o}function Y(e){let n,o,r,c=e[6]+"";return{c(){n=a("option"),o=f(c),n.__value=r=e[6],n.value=n.__value},m(t,e){l(t,n,e),s(n,o)},p:t,d(t){t&&u(n)}}}function Z(e){let n,r,c,i,m,y,v,k,x,_,w,E,C,S,j,A,O,z,P,T,B,L,R,q,G,M,U,D=e[6],I=[];for(let t=0;t<D.length;t+=1)I[t]=Y(X(e,D,t));return{c(){n=a("div"),r=a("form"),c=a("label"),c.textContent="last.fm username",i=d(),m=a("input"),y=a("br"),v=d(),k=a("label"),k.textContent="track limit",x=d(),_=a("input"),w=a("br"),E=d(),C=a("label"),C.textContent="time period",S=d(),j=a("select");for(let t=0;t<I.length;t+=1)I[t].c();A=a("br"),O=d(),z=a("button"),z.textContent="Get Data",P=d(),T=a("div"),B=a("textarea"),L=d(),R=a("button"),q=f("Next"),h(c,"class","form-label svelte-16mug8m"),h(c,"for","username"),h(m,"class","form-input svelte-16mug8m"),h(m,"name","username"),h(m,"type","text"),h(k,"class","form-label svelte-16mug8m"),h(k,"for","limit"),h(_,"class","form-input svelte-16mug8m"),h(_,"name","limit"),h(_,"type","number"),h(_,"min","1"),h(_,"max","100"),h(C,"class","form-label svelte-16mug8m"),h(C,"for","period"),h(j,"class","form-input svelte-16mug8m"),h(j,"name","period"),void 0===e[1]&&N((()=>e[9].call(j))),h(z,"id","submit-button"),h(z,"class","svelte-16mug8m"),h(r,"class","item-form svelte-16mug8m"),B.readOnly=!0,h(B,"id","song-output"),h(B,"rows","limit"),h(B,"cols","50"),h(B,"class","svelte-16mug8m"),h(T,"class","item-output svelte-16mug8m"),h(n,"class","container svelte-16mug8m"),h(R,"id","next-button"),R.disabled=G=""==e[3],h(R,"class","svelte-16mug8m")},m(t,o){l(t,n,o),s(n,r),s(r,c),s(r,i),s(r,m),b(m,e[0]),s(r,y),s(r,v),s(r,k),s(r,x),s(r,_),b(_,e[2]),s(r,w),s(r,E),s(r,C),s(r,S),s(r,j);for(let t=0;t<I.length;t+=1)I[t].m(j,null);var u;$(j,e[1]),s(r,A),s(r,O),s(r,z),s(n,P),s(n,T),s(T,B),b(B,e[3]),l(t,L,o),l(t,R,o),s(R,q),M||(U=[p(m,"input",e[7]),p(_,"input",e[8]),p(j,"change",e[9]),p(z,"click",e[4],{once:!0}),p(r,"submit",(u=e[4],function(t){return t.preventDefault(),u.call(this,t)})),p(B,"input",e[10]),p(R,"click",e[5],{once:!0})],M=!0)},p(t,[e]){if(1&e&&m.value!==t[0]&&b(m,t[0]),4&e&&g(_.value)!==t[2]&&b(_,t[2]),64&e){let n;for(D=t[6],n=0;n<D.length;n+=1){const o=X(t,D,n);I[n]?I[n].p(o,e):(I[n]=Y(o),I[n].c(),I[n].m(j,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=D.length}66&e&&$(j,t[1]),8&e&&b(B,t[3]),8&e&&G!==(G=""==t[3])&&(R.disabled=G)},i:t,o:t,d(t){t&&u(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(I,t),t&&u(L),t&&u(R),M=!1,o(U)}}}const tt="57411198178c595fbb09fabbe83934ac";function et(t,e,n){let o;i(t,W,(t=>n(12,o=t)));let r="leo26299";const c=["overall","7day","1month","3month","6month","12month"];let s,l="7day",u=20,a="";return[r,l,u,a,async function(){await async function(){console.log("fetching last.fm data...");const t="http://ws.audioscrobbler.com/2.0/?method=user.gettoptracks&user="+r+"&period="+l+"&limit="+u+"&api_key="+tt+"&format=json";await fetch(t).then((t=>t.json())).then((t=>{s=t.toptracks.track,console.log("...done!")}))}(),""!=a&&n(3,a="");for(let t=0;t<s.length;t++)n(3,a+=t+1+": "),n(3,a+=s[t].artist.name+" - "),n(3,a+=s[t].name+"\r\n")},function(){var t;o=s,t=o,W.set(t)},c,function(){r=this.value,n(0,r)},function(){u=g(this.value),n(2,u)},function(){l=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(1,l),n(6,c)},function(){a=this.value,n(3,a)}]}class nt extends D{constructor(t){super(),U(this,t,et,Z,c,{})}}function ot(t){let e,n,o,r,c,i,f,m,g,b,$,y;return{c(){e=a("div"),n=a("a"),o=a("button"),o.textContent="Connect to Spotify",r=d(),c=a("br"),i=d(),f=a("div"),m=a("label"),m.textContent="Remember me?",g=d(),b=a("input"),h(o,"class","login-btn"),h(n,"href",t[2]),h(m,"id","checkbox-text"),h(m,"for","remember-me"),h(b,"id","checkbox-box"),h(b,"name","remember-me"),h(b,"type","checkbox"),h(f,"id","checkbox-container"),h(e,"id","login")},m(u,a){l(u,e,a),s(e,n),s(n,o),s(e,r),s(e,c),s(e,i),s(e,f),s(f,m),s(f,g),s(f,b),b.checked=t[0],$||(y=p(b,"change",t[6]),$=!0)},p(t,e){4&e&&h(n,"href",t[2]),1&e&&(b.checked=t[0])},d(t){t&&u(e),$=!1,y()}}}function rt(t){let e,n,o,r,c;return{c(){e=a("section"),n=a("p"),n.textContent="Token expired! Please log out and log back in again.",o=d(),r=a("a"),c=a("button"),c.textContent="Logout",h(r,"href",t[1]),h(e,"class","expired-token")},m(t,i){l(t,e,i),s(e,n),s(e,o),s(e,r),s(r,c)},p(t,e){2&e&&h(r,"href",t[1])},d(t){t&&u(e)}}}function ct(e){let n,o,r=!e[3]&&ot(e),c=e[4]&&rt(e);return{c(){r&&r.c(),n=d(),c&&c.c(),o=m()},m(t,e){r&&r.m(t,e),l(t,n,e),c&&c.m(t,e),l(t,o,e)},p(t,[e]){t[3]?r&&(r.d(1),r=null):r?r.p(t,e):(r=ot(t),r.c(),r.m(n.parentNode,n)),t[4]?c?c.p(t,e):(c=rt(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},i:t,o:t,d(t){r&&r.d(t),t&&u(n),c&&c.d(t),t&&u(o)}}}function it(t,e,n){let o,r,c,s,l;i(t,K,(t=>n(1,c=t))),i(t,H,(t=>n(3,s=t))),i(t,V,(t=>n(4,l=t)));const u=new URL("https://accounts.spotify.com/authorize?"),a=function(t){let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let o=0;o<t;o++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}(16);let f=!0;return t.$$.update=()=>{3&t.$$.dirty&&n(5,o=new URLSearchParams({response_type:"token",show_dialog:!f,client_id:"e27568bbeef44f7db83b446e2d6f57ab",scope:"user-read-private user-read-email playlist-modify-public playlist-modify-private playlist-read-private",redirect_uri:c,state:a})),32&t.$$.dirty&&n(2,r=u+o)},[f,c,r,s,l,o,function(){f=this.checked,n(0,f)}]}class st extends D{constructor(t){super(),U(this,t,it,ct,c,{})}}function lt(e){let n,r,c,i,s,f,m,g;return{c(){n=a("label"),n.textContent="Name der Playlist",r=d(),c=a("input"),i=a("br"),s=d(),f=a("button"),f.textContent="Playlist erstellen",h(n,"class","label"),h(n,"for","playlist-name"),h(c,"class","input"),h(c,"name","playlist-name"),h(c,"type","text")},m(t,o){l(t,n,o),l(t,r,o),l(t,c,o),b(c,e[0]),l(t,i,o),l(t,s,o),l(t,f,o),m||(g=[p(c,"input",e[2]),p(f,"click",e[1],{once:!0})],m=!0)},p(t,[e]){1&e&&c.value!==t[0]&&b(c,t[0])},i:t,o:t,d(t){t&&u(n),t&&u(r),t&&u(c),t&&u(i),t&&u(s),t&&u(f),m=!1,o(g)}}}function ut(t,e,n){let o,r,c,s;i(t,H,(t=>n(5,o=t))),i(t,W,(t=>n(6,r=t))),i(t,V,(t=>n(7,c=t))),i(t,Q,(t=>n(8,s=t)));let l,u,a="last.fm top 50";async function f(t,e){console.log("searching for: ",t," - ",e);const n=`https://api.spotify.com/v1/search?q=track:${t}%20artist:${e}&type=track&limit=5`,r=o;let c;return await fetch(n,{method:"GET",headers:{Authorization:"Bearer "+r}}).then((t=>{if(t.ok)return t.json();throw new Error("Track not found - skipping")})).then((t=>{console.log(t),console.log("track_id found: ",t.tracks.items[0].uri),c=t.tracks.items[0].uri})).catch((t=>{console.log(t)})),c}return k((()=>{console.log("token: ",o),console.log("time range: ",s),console.log("token expired: ",c),console.log("track data: ",r)})),[a,async function(){await async function(){const t=o;await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:"Bearer "+t}}).then((t=>t.json())).then((t=>{l=t.id}))}(),console.log("creating playlist for user ",l);const t=o,e=await fetch(`https://api.spotify.com/v1/users/${l}/playlists`,{method:"POST",headers:{Authorization:"Bearer "+t},body:JSON.stringify({name:a,description:"New playlist description",public:!1})});e.ok?u=await e.json():V.set(!0),async function(){const t=[];for(let e=0;e<r.length;e++)t.push(await f(r[e].name,r[e].artist.name));console.log("finished getting track ids:",t);const e=o,n=`https://api.spotify.com/v1/playlists/${u.id}/tracks`;await fetch(n,{method:"POST",headers:{Authorization:"Bearer "+e},body:JSON.stringify({uris:t})}).then((t=>{if(t.ok)return t.json();throw new Error("Adding to playlist not successful")})).then((t=>{console.log("add to playlist RESPONSE: ",t)})).catch((t=>{console.log(t)}))}()},function(){a=this.value,n(0,a)}]}class at extends D{constructor(t){super(),U(this,t,ut,lt,c,{})}}function ft(t){let e,n;return e=new at({}),{c(){R(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function dt(t){let e,n;return e=new nt({}),{c(){R(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function mt(t){let e,n;return e=new st({}),{c(){R(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function pt(t){let e,n,r,c;const i=[mt,dt,ft],s=[];function a(t,e){return!t[0]||t[1]?0:t[2]?t[0]&&t[2]?2:-1:1}return~(e=a(t))&&(n=s[e]=i[e](t)),{c(){n&&n.c(),r=m()},m(t,n){~e&&s[e].m(t,n),l(t,r,n),c=!0},p(t,[c]){let l=e;e=a(t),e!==l&&(n&&(T={r:0,c:[],p:T},L(s[l],1,1,(()=>{s[l]=null})),T.r||o(T.c),T=T.p),~e?(n=s[e],n||(n=s[e]=i[e](t),n.c()),B(n,1),n.m(r.parentNode,r)):n=null)},i(t){c||(B(n),c=!0)},o(t){L(n),c=!1},d(t){~e&&s[e].d(t),t&&u(r)}}}function ht(t,e,n){let o,r,c;return i(t,H,(t=>n(0,o=t))),i(t,V,(t=>n(1,r=t))),i(t,W,(t=>n(2,c=t))),[o,r,c]}return new class extends D{constructor(t){super(),U(this,t,ht,pt,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
